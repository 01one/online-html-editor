<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Shareable Link Including The Html Code</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.css">
    <style>
        body {
            background-color: #f7f7f7;
            padding-top: 40px;
            padding-bottom: 40px;
        }


        .column {
            max-width: 600px !important;
        }
        #copyBtn {
            transition: opacity 0.5s ease;
        }

        .ui.segment {
            background-color: #f0f0f0;
        }

        .ui.form .field textarea {
            min-height: 100px;
        }
    </style>
</head>

<body>
    <div id="main-container">
        <div class="ui middle aligned center aligned grid">
            <div class="column">
                <h2 class="ui teal image header">
                    <div class="content">
                        URI Generator
                    </div>
                </h2>
                <div class="ui large form">
                    <div class="ui segment">
                        <div class="field">
                            <label>Paste HTML Content:</label>
                            <textarea id="htmlContent" rows="6"
                                placeholder="Paste your HTML content here..."></textarea>
                        </div>
                    </div>
                    <div class="ui segment">
                        <div class="field">
                            <label>Generated URI:</label>
                            <div class="ui action input">
                                <input type="text" id="uriOutput" readonly>
                                <button id="copyBtn" class="ui teal button" onclick="copyURI()">Copy URI</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.9/purify.min.js"></script>
    <script>
        function generateEditorURL(TheExampleHtmlContent) {
            const encodedContent = encodeURIComponent(TheExampleHtmlContent);
            const editorURL = "https://01one.github.io/online-html-editor/?example=" + encodedContent;
            return editorURL;
        }

        function copyURI() {
            var uriOutput = document.getElementById("uriOutput");
            uriOutput.select();
            document.execCommand("copy");

            var copyBtn = document.getElementById("copyBtn");
            copyBtn.textContent = "Copied";
            setTimeout(function () {
                copyBtn.textContent = "Copy URI";
            }, 1500);
        }

        document.getElementById("htmlContent").addEventListener("input", function () {
            var htmlContent = document.getElementById("htmlContent").value;
            
            //var sanitizedHtmlContent = DOMPurify.sanitize(htmlContent);
            
            //var generatedURI = generateEditorURL(sanitizedHtmlContent);
            var generatedURI = generateEditorURL(htmlContent);
            const exampleContent = urlParams.get('generatedURI');
            const sanitizedExampleContent = DOMPurify.sanitize(decodeURIComponent(exampleContent || ""));
            var generatedShareURI = generateEditorURL(sanitizedExampleContent);

            
            document.getElementById("uriOutput").value = generatedShareURI ;
        });
    </script>
</body>

</html>
